(function(){new Vue({el:"#app",data:function(){return{order:{isLoading:!1,filter:{CurrentPage:1,ItemsPerPage:50,OrderBy:6,OrderByDesc:!0},items:[],modal:undefined,details:{}}}},methods:{fetchOrders:function(){return this.order.isLoading=!0,apiService.Get("order",this.order.filter).then(n=>{this.order.items=this.order.items.concat(n.Items),this.order.TotalNumberOfItems=n.TotalNumberOfItems,this.order.CurrentPage=n.CurrentPage,pagination.InfiniteScroll(this.$refs.orderTable,n,this.getNextPage)}).finally(()=>{this.order.isLoading=!1})},saveOrder:function(){if(!(this.order.details.OrderId>0))return this.order.isLoading=!0,apiService.Post("order",this.order.details).then(()=>{this.order.modal.hide(),this.filterChanged()})},createNewOrder:function(){this.order.details={};this.order.modal.show()},showOrderDetails:function(n){this.order.details=n;this.order.modal.show()},getNextPage:function(){this.order.filter.CurrentPage++;this.fetchOrders()},filterChanged:function(){this.order.items=[];this.order.filter.CurrentPage=1;this.fetchOrders()},filterChangedTimeout:function(){clearTimeout(filterTimeout);filterTimeout=setTimeout(this.filterChanged,500)},orderBy:function(n){this.order.filter=orderByHandler.Handle(this.order.filter,n);this.filterChanged()},datetimeLong:function(n){return dayjs(n).format("DD.MM.YYYY HH:mm")}},computed:{},watch:{"order.isLoading":function(n){n?loadHandler.AddTableLoader(this.$refs.orderTable):loadHandler.RemoveTableLoader(this.$refs.orderTable)}},mounted:function(){this.fetchOrders();this.order.modal=new bootstrap.Modal(this.$refs.orderModal)}})})();